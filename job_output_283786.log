cpu-bind=MASK - gpu19-1.drl, task  0  0 [2054423]: mask 0x1 set
Fri May 10 10:21:16 PM EDT 2024
Running my job on gpu19-1.drl
/tmp/home/amini/.local/lib/python3.10/site-packages/deeplake/util/check_latest_version.py:32: UserWarning: A newer version of deeplake (3.9.5) is available. It's recommended that you update to the latest version using `pip install -U deeplake`.
  warnings.warn(
SETTING DEVICE AS cuda
Opening dataset in read-only mode as you don't have write permissions.
This dataset can be visualized in Jupyter Notebook by ds.visualize() or at https://app.activeloop.ai/activeloop/wiki-art

/ - \ hub://activeloop/wiki-art loaded successfully.

/tmp/home/amini/.local/lib/python3.10/site-packages/deeplake/integrations/pytorch/common.py:137: UserWarning: Decode method for tensors ['images'] is defaulting to numpy. Please consider specifying a decode_method in .pytorch() that maximizes the data preprocessing speed based on your transformation.
  warnings.warn(
Please wait, filling up the shuffle buffer with samples.:   0%|          | 0.00/2.00G [00:00<?, ?B/s]Please wait, filling up the shuffle buffer with samples.:   0%|          | 2.11M/2.00G [00:01<21:40, 1.65MB/s]Please wait, filling up the shuffle buffer with samples.:   1%|          | 18.1M/2.00G [00:02<03:46, 9.40MB/s]Please wait, filling up the shuffle buffer with samples.:   6%|▋         | 131M/2.00G [00:02<00:22, 89.4MB/s] Please wait, filling up the shuffle buffer with samples.:  12%|█▏        | 245M/2.00G [00:03<00:19, 97.6MB/s]Please wait, filling up the shuffle buffer with samples.:  15%|█▍        | 303M/2.00G [00:04<00:17, 102MB/s] Please wait, filling up the shuffle buffer with samples.:  24%|██▍       | 488M/2.00G [00:04<00:07, 221MB/s]Please wait, filling up the shuffle buffer with samples.:  34%|███▍      | 695M/2.00G [00:05<00:08, 167MB/s]Please wait, filling up the shuffle buffer with samples.:  41%|████▏     | 849M/2.00G [00:06<00:05, 220MB/s]Please wait, filling up the shuffle buffer with samples.:  58%|█████▊    | 1.17G/2.00G [00:06<00:02, 344MB/s]Please wait, filling up the shuffle buffer with samples.:  63%|██████▎   | 1.25G/2.00G [00:06<00:02, 379MB/s]Please wait, filling up the shuffle buffer with samples.:  66%|██████▌   | 1.32G/2.00G [00:07<00:02, 325MB/s]Please wait, filling up the shuffle buffer with samples.:  71%|███████   | 1.42G/2.00G [00:10<00:05, 113MB/s]Please wait, filling up the shuffle buffer with samples.:  81%|████████  | 1.61G/2.00G [00:10<00:02, 182MB/s]Please wait, filling up the shuffle buffer with samples.:  91%|█████████ | 1.82G/2.00G [00:12<00:01, 125MB/s]Please wait, filling up the shuffle buffer with samples.:  99%|█████████▊| 1.97G/2.00G [00:13<00:00, 155MB/s]Please wait, filling up the shuffle buffer with samples.:  99%|█████████▉| 1.99G/2.00G [00:13<00:00, 161MB/s]
/tmp/home/amini/.local/lib/python3.10/site-packages/torch/utils/_device.py:78: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  return func(*args, **kwargs)
/tmp/home/amini/.local/lib/python3.10/site-packages/torch/utils/_device.py:78: UserWarning: Using a target size (torch.Size([1, 64, 64])) that is different to the input size (torch.Size([8, 64, 64])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return func(*args, **kwargs)
/tmp/home/amini/.local/lib/python3.10/site-packages/torch/utils/_device.py:78: UserWarning: Using a target size (torch.Size([1, 128, 128])) that is different to the input size (torch.Size([8, 128, 128])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return func(*args, **kwargs)
/tmp/home/amini/.local/lib/python3.10/site-packages/torch/utils/_device.py:78: UserWarning: Using a target size (torch.Size([8, 128, 256, 256])) that is different to the input size (torch.Size([1, 128, 256, 256])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return func(*args, **kwargs)
/tmp/home/amini/.local/lib/python3.10/site-packages/torch/utils/_device.py:78: UserWarning: Using a target size (torch.Size([1, 256, 256])) that is different to the input size (torch.Size([8, 256, 256])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  return func(*args, **kwargs)
/tmp/home/amini/.local/lib/python3.10/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/tmp/home/amini/.local/lib/python3.10/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=VGG16_Weights.IMAGENET1K_V1`. You can also use `weights=VGG16_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Shuffle buffer filling is complete.
Building the style transfer model..
Optimizing..
0
20
40
run [50]:
Style Loss : 2.052962 Content Loss: 3.252975

60
80
run [100]:
Style Loss : 1.746056 Content Loss: 3.192168

100
120
140
run [150]:
Style Loss : 1.658251 Content Loss: 3.155570

160
180
run [200]:
Style Loss : 1.595590 Content Loss: 3.137548

200
220
240
run [250]:
Style Loss : 1.540047 Content Loss: 3.131289

260
280
run [300]:
Style Loss : 1.494243 Content Loss: 3.121671

300
Optimizing..
run [25]:
Loss : 0.002328, Floss: 0.002327, Mloss 0.000000

run [50]:
Loss : 0.000719, Floss: 0.000718, Mloss 0.000001

run [75]:
Loss : 0.000334, Floss: 0.000333, Mloss 0.000001

run [100]:
Loss : 0.000187, Floss: 0.000186, Mloss 0.000001

run [125]:
Loss : 0.000119, Floss: 0.000118, Mloss 0.000001

run [150]:
Loss : 0.000085, Floss: 0.000084, Mloss 0.000001

run [175]:
Loss : 0.000064, Floss: 0.000063, Mloss 0.000001

run [200]:
Loss : 0.000050, Floss: 0.000049, Mloss 0.000001

run [225]:
Loss : 0.000041, Floss: 0.000039, Mloss 0.000002

run [250]:
Loss : 0.000034, Floss: 0.000033, Mloss 0.000002

run [275]:
Loss : 0.000029, Floss: 0.000028, Mloss 0.000002

run [300]:
Loss : 0.000025, Floss: 0.000024, Mloss 0.000002

run [325]:
Loss : 0.000022, Floss: 0.000021, Mloss 0.000002

run [350]:
Loss : 0.000020, Floss: 0.000018, Mloss 0.000002

run [375]:
Loss : 0.000018, Floss: 0.000016, Mloss 0.000002

run [400]:
Loss : 0.000017, Floss: 0.000015, Mloss 0.000002

(512, 512, 3)
Traceback (most recent call last):
  File "/data/scratch/amini/sadhana/2024/crypto-final-project/src/data_generation.py", line 363, in <module>
    save_im(glazed_output[i].squeeze(), f"decrypt_data/{i * batch_size + j}_encrypted")
  File "/data/scratch/amini/sadhana/2024/crypto-final-project/src/data_generation.py", line 339, in save_im
    im.save(f"{fname}.jpg")
  File "/tmp/home/amini/.local/lib/python3.10/site-packages/PIL/Image.py", line 2429, in save
    fp = builtins.open(filename, "w+b")
FileNotFoundError: [Errno 2] No such file or directory: 'decrypt_data/0_encrypted.jpg'
